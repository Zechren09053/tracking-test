-- Create the announcements table with scheduling support
CREATE TABLE `announcements` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `title` VARCHAR(255) NOT NULL,
  `message` TEXT NOT NULL,
  `created_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP(),
  `display_from` DATE NOT NULL, -- When the announcement should start displaying
  `display_duration` INT(11) NOT NULL, -- Number of days the announcement should remain visible
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Query to fetch currently active announcements
SELECT *
FROM `announcements`
WHERE CURDATE() BETWEEN `display_from` AND DATE_ADD(`display_from`, INTERVAL `display_duration` DAY);




CREATE TABLE `downstream_schedules` (
  `id` int(11) NOT NULL,
  `route_name` varchar(255) NOT NULL DEFAULT 'Pinagbuhatan → Escolta',
  `row_id` int(11) NOT NULL,
  `col_id` int(11) NOT NULL,
  `station_name` varchar(255) NOT NULL,
  `schedule_time` time NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
CREATE TABLE `ferries` (
  `id` int(11) NOT NULL,
  `name` varchar(255) NOT NULL,
  `latitude` decimal(9,6) DEFAULT NULL,
  `longitude` decimal(9,6) DEFAULT NULL,
  `last_updated` timestamp NOT NULL DEFAULT current_timestamp(),
  `active_time` float DEFAULT NULL,
  `status` varchar(20) NOT NULL DEFAULT 'inactive',
  `operator` varchar(100) DEFAULT NULL,
  `status_changed_at` timestamp NOT NULL DEFAULT current_timestamp(),
  `max_capacity` int(11) NOT NULL DEFAULT 30,
  `current_capacity` int(11) NOT NULL DEFAULT 0,
  `speed` float DEFAULT 0,
  `route_index` int(11) DEFAULT 0
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
CREATE TABLE `ferry_locations` (
  `id` int(11) NOT NULL,
  `code` varchar(50) NOT NULL,
  `latitude` decimal(10,8) NOT NULL,
  `longitude` decimal(11,8) NOT NULL,
  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `last_updated` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
CREATE TABLE `ferry_logs` (
  `id` int(11) NOT NULL,
  `ferry_id` int(11) NOT NULL,
  `trip_date` datetime DEFAULT current_timestamp(),
  `passenger_count` int(11) NOT NULL,
  `speed` float DEFAULT 0,
  `latitude` decimal(9,6) DEFAULT NULL,
  `longitude` decimal(9,6) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
CREATE TABLE `ferry_routes` (
  `id` int(11) NOT NULL,
  `route_name` varchar(100) DEFAULT NULL,
  `origin` varchar(50) DEFAULT NULL,
  `destination` varchar(50) DEFAULT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
CREATE TABLE `ferry_stops` (
  `id` int(11) NOT NULL,
  `route_id` int(11) DEFAULT NULL,
  `stop_name` varchar(50) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
CREATE TABLE `login_attempts` (
  `ip_address` varchar(45) NOT NULL,
  `attempts` int(11) NOT NULL DEFAULT 1,
  `last_attempt` timestamp NOT NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
CREATE TABLE `passenger_id_pass` (
  `id` int(11) NOT NULL,
  `passenger_id` int(11) NOT NULL,
  `full_name` varchar(100) NOT NULL,
  `birth_date` date NOT NULL,
  `profile_image` varchar(255) DEFAULT NULL,
  `email` varchar(100) NOT NULL,
  `phone_number` varchar(20) NOT NULL,
  `qr_code_data` varchar(255) NOT NULL,
  `issued_at` datetime DEFAULT current_timestamp(),
  `expires_at` datetime NOT NULL,
  `is_active` tinyint(1) DEFAULT 1,
  `last_used` datetime DEFAULT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
CREATE TABLE `staff_users` (
  `staff_id` int(11) NOT NULL,
  `username` varchar(50) NOT NULL,
  `email` varchar(100) NOT NULL,
  `password` varchar(255) NOT NULL,
  `role` enum('super_admin','admin','employee') NOT NULL,
  `first_name` varchar(50) NOT NULL,
  `middle_name` varchar(50) DEFAULT NULL,
  `last_name` varchar(50) NOT NULL,
  `position` varchar(100) DEFAULT NULL,
  `is_active` tinyint(1) DEFAULT 1,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),
  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `profile_pic` varchar(255) DEFAULT 'default.png'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

CREATE TABLE `upstream_schedules` (
  `id` int(11) NOT NULL,
  `route_name` varchar(255) NOT NULL DEFAULT 'Escolta → Kalawaan',
  `row_id` int(11) NOT NULL,
  `col_id` int(11) NOT NULL,
  `station_name` varchar(255) NOT NULL,
  `schedule_time` time NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;


CREATE TABLE boat_maintenance (
  id INT AUTO_INCREMENT PRIMARY KEY,
  ferry_id INT NOT NULL,
  maintenance_date DATE NOT NULL,
  maintenance_type VARCHAR(100) NOT NULL, -- e.g., "Engine Overhaul"
  performed_by VARCHAR(100),
  notes TEXT,
  next_due_date DATE,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (ferry_id) REFERENCES ferries(id)
);



CREATE TABLE repair_logs (
  id INT AUTO_INCREMENT PRIMARY KEY,
  ferry_id INT NOT NULL,
  reported_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  repair_date DATE,
  issue TEXT NOT NULL,
  repair_action TEXT,
  repaired_by VARCHAR(100),
  cost DECIMAL(10,2),
  status ENUM('Pending','In Progress','Completed') DEFAULT 'Pending',
  FOREIGN KEY (ferry_id) REFERENCES ferries(id)
);
CREATE TABLE passengers (
  id INT AUTO_INCREMENT PRIMARY KEY,
  full_name VARCHAR(100) NOT NULL,
  email VARCHAR(100),
  phone_number VARCHAR(20),
  registered_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);


CREATE TABLE users (
  id INT AUTO_INCREMENT PRIMARY KEY,
  full_name VARCHAR(100) NOT NULL,
  birth_date DATE NOT NULL,
  profile_image VARCHAR(255),  -- optional, can be a file path or URL
  email VARCHAR(100) NOT NULL UNIQUE,
  phone_number VARCHAR(20) NOT NULL,
  qr_code_data VARCHAR(255) NOT NULL,  -- this will be encoded in their QR
  issued_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  expires_at DATETIME NOT NULL,
  is_active TINYINT(1) DEFAULT 1,
  last_used DATETIME DEFAULT NULL,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);


CREATE TABLE tickets (
  id INT AUTO_INCREMENT PRIMARY KEY,
  user_id INT NOT NULL,  -- from users table
  ferry_id INT NOT NULL, -- from ferries table
  ticket_type VARCHAR(50) NOT NULL,  -- e.g., 'Regular', 'Student', 'Senior'
  amount DECIMAL(10,2) NOT NULL,
  purchase_date DATETIME DEFAULT CURRENT_TIMESTAMP,
  valid_until DATETIME,  -- optional, for time-limited passes
  FOREIGN KEY (user_id) REFERENCES users(id),
  FOREIGN KEY (ferry_id) REFERENCES ferries(id)
);





to do list

user int

sched and route

fix tracking live

make user id card

rbac

station stops
Loading:
Unloading:

proximity announcement



print reports per station?/



announcements
downstream_schedules
ferries
ferry_locations
ferry_logs
ferry_routes
ferry_stops
login_attempts
passenger_id_pass
staff_users
tickets
upstream_schedules



















 Main Pasig River Ferry Stations (11):
Pinagbuhatan – Pasig City (easternmost terminus)

San Joaquin – Pasig City

Maybunga (branch/extension — see below)

Bambang – Pasig City

Kalawaan – Pasig City

Guadalupe – Makati City

Hulo – Mandaluyong City

Lambingan – Sta. Ana, Manila

Sta. Ana – Manila

PUP – Polytechnic University of the Philippines, Manila

Lawton – Near Intramuros and Manila Post Office

Escolta – Binondo, Manila

Plaza Mexico (Intramuros) – Near the mouth of the river